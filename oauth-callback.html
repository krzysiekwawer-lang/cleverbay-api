<script>
function getTokenFromUrl() {
    const hash = window.location.hash.substring(1);
    const params = new URLSearchParams(hash);
    return params.get('access_token');
}

function sendTokenToApp() {
    const token = getTokenFromUrl();
    
    if (token) {
        console.log("Token received:", token.substring(0, 20) + "...");
        
        // Próbuj przekazać token do aplikacji przez WebView interface
        if (window.Android && typeof window.Android.onOAuthTokenReceived === 'function') {
            window.Android.onOAuthTokenReceived(token);
        } else {
            // Fallback: przekieruj przez deep link
            console.log("Using deep link fallback");
            window.location.href = 'cleverbay://oauth?token=' + encodeURIComponent(token);
        }
    } else {
        console.log("No token found in URL");
    }
}

window.onload = sendTokenToApp;
</script>
